<!--
	Copyright (c) 2018 Andy Bao

	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	SOFTWARE.
-->
<!--
	HTML Settings Page
-->
<html>
	<head>
		<title>DynamicHistory Settings</title>
		<!-- JQuery 3.5.1 -->
		<script src="jquery-3.5.1.min.js"></script>
		<!-- Moment 2.27.0 -->
		<script src="moment.min.js"></script>
		<!-- Shared -->
		<script src="shared.js"></script>
		<!-- Core Javascript -->
		<script src="options.js"></script>
		<style>
/* Chrome v84*/
/* Default width is narrow and height can't be changed. */
html {
	width: 1200px;
}

body {
	margin: 0 18px;
}

/* Firefox  v78 */
/* Fixed width and height. Margin of 16px by default. */
@media (width: 632px) {
	html {
		width: 632px;
	}

	body {
		margin: 0 2px;
	}
}

/* Edge v84 */
/* Dimensions can't be changed. Width is so small that I removed the margins to make some room. */
@media (width: 400px) {
	html {
		width: auto;
	}

	body {
		margin: 0;
	}
}


body {
	background-color: #ffffff;
	color: #0c0c0d;
	font-size: 15px;
}

a {
	color: #45a1ff;
	text-decoration: none;
}

form {
	margin-bottom: 4px;
}

.optioncontainer {
	margin: 0 0 30px 0;
}

.optiontitle {
	font-size: 17px;
}

.sectiontitle {
	font-size: 22px;
	margin-top: 22px;
}

.maintitle {
	font-size: 32px;
	margin-top: 20px;
}

.sectiontitle,
.maintitle {
	border-bottom: 1px solid #4a4a4f;
	font-weight: bold;
}

.sectiontitle {
	margin: 60px 0 20px 0;
}

.optiondescription {
	color: #4a4a4f;
}

textarea {
	height: 150px;
	width: 100%;
	margin: 5px 0;
	padding: 3px;
	resize: vertical;
	font-size: 13px;
}

input[type="checkbox"] {
	margin-right: 1px;
}

input[type="text"] {
	height: 25px;
	margin-left: 5px;
}

input[type="color"] {
	height: 25px;
	width: 25px;
	padding: 0;
	vertical-align: bottom;
}

textarea,
input[type="text"] {
	color: #0c0c0d !important;
	font-family: Courier New;
}

textarea,
input[type="text"],
input[type="color"] {
	border: 1px solid #b1b1b3;
	border-radius: 2px;
}


.modal {
	height: 100%;
	width: 100%;
	left: 0;
	top: 0;
	background-color: rgba(0, 0, 0, 0.4);
	display: none;
	overflow: auto;
	padding-top: 200px;
	position: fixed;
	z-index: 1;
}

.modal-content {
	width: 80%;
	position: fixed;
	bottom: 200px;
	left: 10%;
	background-color: #fefefe;
	border: 1px solid #888;
	border-radius: 7px;
	padding: 0;
	box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);
	animation-name: animate;
	animation-duration: 0.4s;
}

.modal-header {
	color: #2a2a2e;
	font-size: 22px;
	padding: 8px 16px;
	font-weight: bold;
	border-radius: 7px 7px 0 0;
}

#clear_modal .modal-header {
	background-color: #ffe900;
}

#restore_modal .modal-header {
	background-color: #30e60b;
}

.modal-closebutton {
	color: #2a2a2e;
	float: right;
	font-size: 28px;
	font-weight: bold;
	position: relative;
	top: -6px;
}

.modal-closebutton:hover,
.modal-closebutton:focus {
	opacity: 0.6;
	text-decoration: none;
	cursor: pointer;
}

.modal-body {
	color: #2a2a2e;
	padding: 16px;
}

.modal-footer {
	padding: 16px;
	border-top: 1px solid grey;
}

.modal-footer button {
	width: 60px;
	margin-right: 10px;
}

@keyframes animate {
	from {bottom: 0; opacity: 0}
	to {bottom: 200px; opacity: 1}
}


@media (prefers-color-scheme: dark) {
	body {
		background-color: #202023;
		color: #f9f9fa;
	}

	.sectiontitle,
	.maintitle {
		border-bottom: 1px solid #b1b1b3;
	}

	.optiondescription {
		color: #b1b1b3;
	}

	textarea,
	input[type="text"] {
		color: #f9f9fa !important;
	}

	textarea,
	input[type="text"],
	input[type="color"] {
		background-color: #2a2a2e;
		border: 1px solid #4a4a4f;
	}

	.modal-content {
		background-color: #202023;
	}

	.modal-body {
		color: #f9f9fa;
	}
}
		</style>
	</head>
	<body>

		<div>
			<div class="maintitle">DynamicHistory Settings</div>
			<br>
			<div class="optiontitle"><b>Note:</b> Settings are saved automatically.</div>
			<br>
			<div class="optiontitle">Made by <a href="https://nulldev.xyz">nulldev</a>.</div>


			<div class="sectiontitle">Removal criteria</div>

			<div class="optioncontainer">
				<div class="optiontitle">Dangerous domains</div>
				<div class="optiondescription">Always delete the history entries for these domains:</div>
				<textarea class="browser-style" id="danger_domains" spellcheck="false" placeholder="Example:&#10;&#10;bad.example.com&#10;horrible.bad.com"></textarea>
				<div class="optiontitle">
					<form class="browser-style">
						<input id="do_regex_danger_domains" type="checkbox" />
						<label for="do_regex_danger_domains">Use regex</label>
					</form>
				</div>
			</div>

			<div class="optioncontainer">
				<div class="optiontitle">Safe domains</div>
				<div class="optiondescription">Never delete the history entries for these domains:</div>
				<textarea class="browser-style" id="safe_domains" spellcheck="false" placeholder="Example:&#10;&#10;cool.example.com&#10;god.example.com"></textarea>
				<div class="optiontitle">
					<form class="browser-style">
						<input id="do_regex_safe_domains" type="checkbox" />
						<label for="do_regex_safe_domains">Use regex</label>
					</form>
				</div>
			</div>

			<div class="optioncontainer">
				<div class="optiontitle">Dangerous keywords</div>
				<div class="optiondescription">Delete the history entries for pages containing any of these words:</div>
				<textarea class="browser-style" id="bad_words" placeholder="Example:&#10;&#10;horrible&#10;disgusting&#10;bad"></textarea>
				<div class="optiontitle">
					<form class="browser-style">
						<input id="do_regex_danger_keywords" type="checkbox" />
						<label for="do_regex_danger_keywords">Use regex</label>
					</form>
				</div>
			</div>


			<div class="sectiontitle">Matching options (for advanced users)</div>

			<div class="optioncontainer">
				<div class="optiontitle">
					<form class="browser-style">
						<input id="do_check_entire_url" type="checkbox" />
						<label for="do_check_entire_url">Check entire URL</label>
					</form>
				</div>
				<div class="optiondescription">Check the entire URL (including protocol, path and query) when comparing domains. More useful if regex is enabled.</div>
			</div>

			<div class="optioncontainer">
				<div class="optiontitle">
					<form class="browser-style">
						<input id="scan_all" type="checkbox" />
						<label for="scan_all">Scan full HTML when matching "Dangerous keywords"</label>
					</form>
				</div>
				<div class="optiondescription">Scan all of the HTML code instead of scanning only visible text.</div>
			</div>


			<div class="optioncontainer">
				<div class="optiontitle">
					<form class="browser-style">
						<input id="continuous_matching" type="checkbox" />
						<label for="continuous_matching">Enable continuous matching</label>
					</form>
				</div>
				<div class="optiondescription">Constantly monitor the page for any "dangerous keywords". May adversely affect browser performance. Enable this if DynamicHistory is not working on some pages.</div>
			</div>


			<div class="sectiontitle">Display options</div>

			<div class="optioncontainer">
				<div class="optiontitle">
					<form class="browser-style">
						<input id="do_prefix" type="checkbox" />
						<label for="do_prefix">Append prefix</label>
						<input id="prefix_text" type="text" />
					</form>
				</div>
				<div class="optiondescription">Append this prefix to any tab that has had its history entry removed (buggy on some web pages).</div>
			</div>

			<div class="optioncontainer">
				<div class="optiontitle">
					<form class="browser-style">
						<input id="do_outline" type="checkbox" />
						<label for="do_outline">Outline page</label>
						<span class="browser-style">
							<input id="outline_color" type="color" />
						</span>
					</form>
				</div>
				<div class="optiondescription">Apply a colored outline to the page that has had its history entry removed (buggy on some web pages).</div>
			</div>

			<div class="optioncontainer">
				<div class="optiontitle">
					<form class="browser-style">
						<input id="do_badge" type="checkbox" />
						<label for="do_badge">Show badge</label>
						<span class="browser-style">
							<input id="badge_text" type="text" spellcheck="false" />
							<input id="badge_color" type="color" />
						</span>
					</form>
				</div>
			<div class="optiondescription">Show a badge next to the DynamicHistory icon when viewing a tab that has had its history entry removed.</div>
			</div>

			<div class="optioncontainer">
				<div class="optiontitle">
					<form class="browser-style">
						<input id="inject_css" type="checkbox" />
						<label for="inject_css">Inject CSS</label>
					</form>
				</div>
				<div class="optiondescription">Inject this custom CSS code into any page that has had its history entry removed:</div>
				<textarea class="browser-style" id="css_code" spellcheck="false" placeholder="Example:&#10;&#10;body {&#10;    filter: grayscale(100%);&#10;}"></textarea>
			</div>

			<div class="optioncontainer">
				<div class="optiontitle">
					<form class="browser-style">
						<input id="inject_js" type="checkbox" />
						<label for="inject_js">Inject JavaScript</label>
					</form>
				</div>
				<div class="optiondescription">Inject this custom JavaScript code into any page that has had its history entry removed:</div>
				<textarea class="browser-style" id="js_code" spellcheck="false" placeholder="Example:&#10;&#10;alert(&quot;History removed!&quot;);"></textarea>
			</div>


			<div id="custom_hist_proc" class="optioncontainer">
				<div class="sectiontitle">Advanced</div>

				<div class="optioncontainer">
					<div class="optiontitle">Custom history processor</div>
					<div class="optiondescription">Run a custom JavaScript function to modify history items as they are added to the history database.<br><br><b>Be careful when writing your own history processors</b>, as history processors are run continuously on a history entry until an iteration is reached where the entry is not modified by the history processor. When in doubt, open the console for the background page to monitor your history processor's activities so it doesn't end up in an infinite loop.</div>
					<textarea id="history_processor" class="browser-style" spellcheck="false" placeholder="Example:&#10;&#10;//Pretend that all websites we visit are secure&#10;if(item.url.startsWith(&quot;http&quot;) && !item.url.startsWith(&quot;https&quot;))&#10;    item.url = item.url.replace(&quot;http&quot;, &quot;https&quot;);&#10;&#10;//Remove all FTP URLs&#10;if(item.url.startsWith(&quot;ftp&quot;)&#10;    item.remove();"></textarea><br><br>
					<div class="optiontitle">History processor templates:</div>
					<div id="hp_templates"></div>
				</div>
			</div>


			<div class="sectiontitle" class="browser-style">Backup and restore settings</div>
			<button id="clear_btn" class="browser-style">Reset All Settings</button>
			<button id="backup_btn" class="browser-style">Backup Settings</button>
			<button id="restore_btn" class="browser-style">Restore Settings</button>
			<input id="file_input" style="display:none" type="file" />
			<br><br>
			<a id="oninstall_link" style="display:none" href="oninstall.html">View Installation Instructions</a>

		</div>


		<div id="clear_modal" class="modal">
			<div class="modal-content">
				<div class="modal-header">
					<span class="modal-closebutton">&times;</span>
					<div>Reset all settings?</div>
				</div>
				<div class="modal-body">Are you sure you want to reset all settings to their default values?<br><br>This action is irreversible!</div>
				<div class="modal-footer">
					<button id="clear_yes_btn" class="browser-style">Yes</button>
					<button id="clear_no_btn" class="browser-style">No</button>
				</div>
			</div>
		</div>

		<div id="restore_modal" class="modal">
			<div class="modal-content">
				<div class="modal-header">
					<span class="modal-closebutton">&times;</span>
					<div>Restore complete!</div>
				</div>
				<div class="modal-body">
					<div>Your settings have been restored!</div>
				</div>
				<div class="modal-footer">
					<button id="restore_close_btn">Close</button>
				</div>
			</div>
		</div>

	</body>
</html>
